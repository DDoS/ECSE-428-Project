extends ../layout

block content
    .page-header
        h2 All Questions

    if questions.length == 0
        .row
            .col-md-12
                p
                    | No questions have been submitted. Why not write one of
                    | your own?
    else
        .row
            each question in questions
                .col-md-12
                    +question(question.id, question.title, question.text,
                              question.submitter,  question.date,
                              question.upVoted, question.downVoted,
                              question.voteScore, user)

    .form-group
        +pagination(currPage, '/questions/find/')

mixin question(id, title, text, submitter, date, upVoted, downVoted, count, user)
    .panel.panel-default
        .panel-heading
            h4
                a(href='/questions/view/?q=#{id}')= title
        .panel-body
            .vote-group
                form(method='POST', action='/questions/vote?q=#{id}')
                    .btn-group-vertical
                        button.btn.btn-primary(class=upVoted ? 'active' : undefined,
                        disabled = !user ? 'disabled' : undefined,
                        type='submit', name='vote',
                        value=upVoted ? 'none' : 'up')
                            i.fa.fa-thumbs-up
                        button.btn.btn-default.vote-status(disabled='disabled')
                            span.badge= count
                        button.btn.btn-danger(class=downVoted ? 'active' : undefined,
                        disabled = !user ? 'disabled' : undefined,
                        type='submit', name='vote',
                        value=downVoted ? 'none' : 'down')
                            i.fa.fa-thumbs-down
                    input(type='hidden', name='_csrf', value=csrfToken)
            .vote-panel-text
                each para in text.split('\n')
                    p= para
        .panel-footer
            span.text-muted
                | Submitted by #{submitter} on
                | #{moment(date.toISOString()).format('YYYY-MM-DD HH:m:s')}

mixin pagination(curr, base)
    ul.pagination
        if curr == 1
            li.disabled
                a Prev
        else
            li
                a(href='#{base}?page=#{curr - 1}') Prev

        if locals.hasNextPage
            li
                a(href='#{base}?page=#{curr + 1}') Next
        else
            li.disabled
                a Next
